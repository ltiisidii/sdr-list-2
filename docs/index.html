<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejemplo de Leaflet con JSON</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
    <div id="map" style="height: 600px;"></div>

    <div>
        <label>
            <input type="checkbox" id="kiwisdrCheckbox" checked> Mostrar KiwiSDR
        </label>
        <label>
            <input type="checkbox" id="openwebrxCheckbox" checked> Mostrar OpenWebRX
        </label>
        <label>
            <input type="checkbox" id="websdrCheckbox" checked> Mostrar WebSDR
        </label>
    </div>

    <script>
        var map = L.map('map').setView([0, 0], 2); // Inicializar el mapa Leaflet con centro en [0, 0] y nivel de zoom 2

        // Agregar OpenStreetMap como capa base
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Función para cargar datos JSON y crear marcadores
        function loadJSONMarkers(url, color) {
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    data.forEach(item => {
                        var marker = L.marker([item.lat, item.lon], { color: color }).addTo(map);
                        marker.bindPopup(`<b>ID:</b> ${item.id}<br>
                                          <b>Comentario:</b> ${item.comment}<br>
                                          <b>URL:</b> ${item.url}<br>
                                          <b>Usuarios Máximos:</b> ${item.maxusers}<br>
                                          <b>Altitud:</b> ${item.altitude}<br>
                                          <b>Antena:</b> ${item.antenna}<br>
                                          <b>Dispositivo:</b> ${item.device}`);
                    });
                });
        }

        // Cargar marcadores JSON desde URL según el estado del checkbox
        document.getElementById('kiwisdrCheckbox').addEventListener('change', function() {
            var url = this.checked ? 'https://raw.githubusercontent.com/ltiisidii/sdr-list-2/main/docs/kiwisdr.json' : null;
            if (url) {
                loadJSONMarkers(url, 'green');
            } else {
                map.eachLayer(function(layer) {
                    if (layer instanceof L.Marker && layer.options.color === 'green') {
                        map.removeLayer(layer);
                    }
                });
            }
        });

        document.getElementById('openwebrxCheckbox').addEventListener('change', function() {
            var url = this.checked ? 'https://raw.githubusercontent.com/ltiisidii/sdr-list-2/main/docs/openwebrx.json' : null;
            if (url) {
                loadJSONMarkers(url, 'blue');
            } else {
                map.eachLayer(function(layer) {
                    if (layer instanceof L.Marker && layer.options.color === 'blue') {
                        map.removeLayer(layer);
                    }
                });
            }
        });

        document.getElementById('websdrCheckbox').addEventListener('change', function() {
            var url = this.checked ? 'https://raw.githubusercontent.com/ltiisidii/sdr-list-2/main/docs/websdr.json' : null;
            if (url) {
                loadJSONMarkers(url, 'red');
            } else {
                map.eachLayer(function(layer) {
                    if (layer instanceof L.Marker && layer.options.color === 'red') {
                        map.removeLayer(layer);
                    }
                });
            }
        });

    </script>
</body>
</html>
