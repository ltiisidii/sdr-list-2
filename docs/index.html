<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet JSON Example</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
    <div id="map" style="height: 600px;"></div>

    <div>
        <label>
            <input type="checkbox" id="kiwisdrCheckbox" checked> Mostrar KiwiSDR
        </label>
        <label>
            <input type="checkbox" id="openwebrxCheckbox" checked> Mostrar OpenWebRX
        </label>
        <label>
            <input type="checkbox" id="websdrCheckbox" checked> Mostrar WebSDR
        </label>
    </div>

    <script>
        var map = L.map('map').setView([0, 0], 2); // Initialize Leaflet map with center at [0, 0] and zoom level 2

        // Add OpenStreetMap as base layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Function to load JSON data and create markers
        function loadJSONMarkers(url) {
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    data.forEach(item => {
                        var marker = L.marker([item.latitude, item.longitude]).addTo(map);
                        marker.bindPopup(`<b>ID:</b> ${item.id}<br>
                                          <b>Comment:</b> ${item.comment}<br>
                                          <b>URL:</b> ${item.url}<br>
                                          <b>Max Users:</b> ${item.maxusers}<br>
                                          <b>Altitude:</b> ${item.altitude}<br>
                                          <b>Antenna:</b> ${item.antenna}<br>
                                          <b>Device:</b> ${item.device}`);
                    });
                });
        }

        // Load JSON markers from URL based on checkbox status
        document.getElementById('kiwisdrCheckbox').addEventListener('change', function() {
            var url = this.checked ? 'https://raw.githubusercontent.com/ltiisidii/sdr-list-2/main/docs/kiwisdr.json' : null;
            if (url) {
                loadJSONMarkers(url);
            } else {
                // Remove existing KiwiSDR markers if checkbox is unchecked
                map.eachLayer(function(layer) {
                    if (layer instanceof L.Marker && layer.options.icon.options.iconUrl === 'kiwisdr-icon.png') {
                        map.removeLayer(layer);
                    }
                });
            }
        });

        document.getElementById('openwebrxCheckbox').addEventListener('change', function() {
            var url = this.checked ? 'https://raw.githubusercontent.com/ltiisidii/sdr-list-2/main/docs/openwebrx.json' : null;
            if (url) {
                loadJSONMarkers(url);
            } else {
                // Remove existing OpenWebRX markers if checkbox is unchecked
                map.eachLayer(function(layer) {
                    if (layer instanceof L.Marker && layer.options.icon.options.iconUrl === 'openwebrx-icon.png') {
                        map.removeLayer(layer);
                    }
                });
            }
        });

        document.getElementById('websdrCheckbox').addEventListener('change', function() {
            var url = this.checked ? 'https://raw.githubusercontent.com/ltiisidii/sdr-list-2/main/docs/websdr.json' : null;
            if (url) {
                loadJSONMarkers(url);
            } else {
                // Remove existing WebSDR markers if checkbox is unchecked
                map.eachLayer(function(layer) {
                    if (layer instanceof L.Marker && layer.options.icon.options.iconUrl === 'websdr-icon.png') {
                        map.removeLayer(layer);
                    }
                });
            }
        });

    </script>
</body>
</html>
